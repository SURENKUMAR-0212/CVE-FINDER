//$Id$
package com.mvc.controller;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.URL;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.servlet.ModelAndView;

import com.mvc.model.Item;
import com.mvc.view.ViewParser;


@Controller
public class DetailController {

	@Autowired
	ViewParser viewParse;
	@Autowired
	Item item;
	URL url;
	HttpURLConnection connection;
	ModelAndView modelAndView;

	public DetailController() {
		modelAndView = new ModelAndView();
	}
	
	
	@RequestMapping("/detail/{id}")
	public ModelAndView detail (@PathVariable("id") Integer id) throws IOException {
		
		item = viewParse.gitList().get(id);
		System.out.println("detail i was called...");
		System.out.println("your id +"+ id +" list "+ item);
		modelAndView.setViewName("detail");
		modelAndView.addObject("repo", item.getFullName());
		
		url = item.getReadMeURL();
		
		BufferedReader readMe = new BufferedReader(
		        new InputStreamReader(url.openStream()));

		modelAndView.addObject("evicdenceReadMe", readMe);
		
		return modelAndView;
		
	}
	
}
